@using Models

@if (Units.Count() != 0)
{
	<div class="rvt-grid">
		<div class="rvt-grid__item-6-md-up rvt-p-lr-md">
			<div class="rvt-m-bottom-xl">
				<div class="rvt-grid">
					<div class="rvt-grid__item rvt-border-all rvt-border-radius rvt-bg-white" style="overflow: auto;">
						<div class="rvt-grid">
							<div class="rvt-grid__item rvt-bg-cream rvt-border-bottom rvt-p-all-xs rvt-p-left-md rvt-p-right-md rvt-ts-18 rvt-text-bold"
								style="color: rgb(51, 51, 51);">Supporting Units</div>
						</div>
						@if(ReportSupportingUnit != null)
						{
							<div class="rvt-grid">
								<div class="rvt-grid__item rvt-p-all-md">
									<ul class="rvt-list rvt-plain-list">
										<li>
											<a href="/units/@ReportSupportingUnit.Id">@ReportSupportingUnit.Name</a>
											<span class="rvt-badge rvt-badge--secondary">
												<rvt-icon name="flag" class="rvt-p-tb-xxs" />
												<span style="vertical-align: middle;">Used for Reporting</span>
											</span>
											@if(IsAdmin)
											{
												<a class="rvt-button rvt-button--small rvt-m-left-xs" href="/Departments/@DepartmentId/SetReportingUnit">
													<rvt-icon name="pencil" title="Set Report Supporting Unit"></rvt-icon>
													<span class="rvt-sr-only">Set Report Supporting Unit</span>
												</a>
											}
										</li>
										@if(ReportSupportingUnit.Description != null)
										{
											<div><span>@ReportSupportingUnit.Description</span></div>
										}
									</ul>
								</div>
							</div>
						}

						@if(IsAdmin && ReportSupportingUnit == null && Units.Count() > 0)
						{
							<div class="rvt-alert rvt-alert--info rvt-m-bottom-md" role="alertdialog" aria-labelledby="information-alert-title">
								<h1 class="rvt-alert__title" id="information-alert-title">No Report Supporting Unit Set.</h1>
								<p class="rvt-alert__message">
									Without a Report Supporting Unit set the department may not appear correctly in some reports.
									<div class="rvt-m-top-sm">
										<a class="rvt-button" href="/Departments/@DepartmentId/SetReportingUnit">
											Set Report Supporting Unit
										</a>
									</div>
								</p>
							</div>
						}

						@foreach (var unit in Units.Where(u => u.Id != ReportSupportingUnit?.Id))
						{
							<div class="rvt-grid">
								<div class="rvt-grid__item rvt-p-all-md">
									<ul class="rvt-list rvt-plain-list">
										<li><a href="/units/@unit.Id">@unit.Name</a></li>
										@if (unit.Description != null)
										{
											<div><span>@unit.Description</span></div>
										}
									</ul>
								</div>
							</div>
						}
					</div>
				</div>
			</div>
		</div>
	</div>
}

@code{
	[Parameter]
	public IEnumerable<UnitResponse> Units { get; set; }
	
	[Parameter]
	public Unit ReportSupportingUnit { get; set; }

	[Parameter]
	public string DepartmentId { get; set; }
	
	[Parameter]
	public bool IsAdmin { get; set; } = true;
}